CREATE DATABASE bioreactors
CREATE DATABASE bioreactors_minute
CREATE DATABASE bioreactors_hour
CREATE DATABASE bioreactors_day
CREATE DATABASE bioreactors_debug WITH DURATION 30d REPLICATION 1 SHARD DURATION 1h NAME "oneMonth"

CREATE CONTINUOUS QUERY bio_minute_cq ON bioreactors BEGIN SELECT max(error) AS max_error, count(distinct(eventId)) AS count_distinct_eventId, median(grWeight) AS median_grWeight, median(id) AS median_id, median(liquidTemp) as median_liquidTemp, median(maxWeight) AS median_maxWeight, median(minWeight) AS median_minWeight, median(pcbTemp) AS median_pcbTemp, median(pidTemp) AS median_pidTemp, min(status) AS min_status, median(targetTemp) AS median_targetTemp, median(weight) AS median_weight, median(weightSinceLast) AS median_weightSinceLast INTO bioreactors_minute.autogen.:MEASUREMENT FROM bioreactors.autogen./.*/ GROUP BY time(1m), * END
CREATE CONTINUOUS QUERY bio_hour_cq ON bioreactors BEGIN SELECT max(error) AS max_error, count(distinct(eventId)) AS count_distinct_eventId, median(grWeight) AS median_grWeight, median(id) AS median_id, median(liquidTemp) as median_liquidTemp, median(maxWeight) AS median_maxWeight, median(minWeight) AS median_minWeight, median(pcbTemp) AS median_pcbTemp, median(pidTemp) AS median_pidTemp, min(status) AS min_status, median(targetTemp) AS median_targetTemp, median(weight) AS median_weight, median(weightSinceLast) AS median_weightSinceLast INTO bioreactors_hour.autogen.:MEASUREMENT FROM bioreactors.autogen./.*/ GROUP BY time(1h), * END
CREATE CONTINUOUS QUERY bio_day_cq ON bioreactors BEGIN SELECT max(error) AS max_error, count(distinct(eventId)) AS count_distinct_eventId, median(grWeight) AS median_grWeight, median(id) AS median_id, median(liquidTemp) as median_liquidTemp, median(maxWeight) AS median_maxWeight, median(minWeight) AS median_minWeight, median(pcbTemp) AS median_pcbTemp, median(pidTemp) AS median_pidTemp, min(status) AS min_status, median(targetTemp) AS median_targetTemp, median(weight) AS median_weight, median(weightSinceLast) AS median_weightSinceLast INTO bioreactors_day.autogen.:MEASUREMENT FROM bioreactors.autogen./.*/ GROUP BY time(1d), * END
